/home/webcronx/Projects/g-pfl-ids/src/personalized_evaluator.py:351: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
  plt.show()

Files in personalized_models/fedavg/gae_deepsvdd:
  - personalized_model_0.pt
  - client_center_0.pt
  - personalized_model_1.pt
  - client_center_1.pt
  - personalized_model_2.pt
  - client_center_2.pt
  - personalized_model_3.pt
  - client_center_3.pt
  - personalized_model_4.pt
  - client_center_4.pt
  - personalized_model_5.pt
  - client_center_5.pt
  - personalized_model_6.pt
  - client_center_6.pt
  - personalized_model_7.pt
  - client_center_7.pt
  - personalized_model_8.pt
  - client_center_8.pt
  - personalized_model_9.pt
  - client_center_9.pt
Loaded personalized model and center for client 0
Loaded personalized model and center for client 1
Loaded personalized model and center for client 2
Loaded personalized model and center for client 3
Loaded personalized model and center for client 4
Loaded personalized model and center for client 5
Loaded personalized model and center for client 6
Loaded personalized model and center for client 7
Loaded personalized model and center for client 8
Loaded personalized model and center for client 9
Loaded 10 personalized models

=== Evaluating Client-Specific Performance ===

Evaluating client 0...
Loading 539473 malicious samples with 48 features
Client 0 Results:
  AUROC: 0.9405
  AUPR: 0.9996
  Optimal threshold: 14.3590
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0600
  TPR at 1% FPR: 0.0092
  TPR at 5% FPR: 0.0096
  TPR at 10% FPR: 1.0000

Evaluating client 1...
Loading 539473 malicious samples with 48 features
Client 1 Results:
  AUROC: 0.9955
  AUPR: 1.0000
  Optimal threshold: 19.7577
  Detection Rate (TPR) at optimal threshold: 0.9988
  False Positive Rate at optimal threshold: 0.0372
  TPR at 1% FPR: 0.9784
  TPR at 5% FPR: 1.0000
  TPR at 10% FPR: 1.0000

Evaluating client 2...
Loading 539473 malicious samples with 48 features
Client 2 Results:
  AUROC: 0.9395
  AUPR: 0.9993
  Optimal threshold: 13.1387
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0606
  TPR at 1% FPR: 0.0000
  TPR at 5% FPR: 0.0002
  TPR at 10% FPR: 1.0000

Evaluating client 3...
Loading 539473 malicious samples with 48 features
Client 3 Results:
  AUROC: 0.9807
  AUPR: 0.9999
  Optimal threshold: 14.1385
  Detection Rate (TPR) at optimal threshold: 0.9996
  False Positive Rate at optimal threshold: 0.0672
  TPR at 1% FPR: 0.6942
  TPR at 5% FPR: 0.8180
  TPR at 10% FPR: 1.0000

Evaluating client 4...
Loading 539473 malicious samples with 48 features
Client 4 Results:
  AUROC: 0.9872
  AUPR: 1.0000
  Optimal threshold: 18.4652
  Detection Rate (TPR) at optimal threshold: 0.9997
  False Positive Rate at optimal threshold: 0.0532
  TPR at 1% FPR: 0.6945
  TPR at 5% FPR: 1.0000
  TPR at 10% FPR: 1.0000

Evaluating client 5...
Loading 539473 malicious samples with 48 features
Client 5 Results:
  AUROC: 0.9387
  AUPR: 0.9992
  Optimal threshold: 12.7190
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0614
  TPR at 1% FPR: 0.0016
  TPR at 5% FPR: 0.0028
  TPR at 10% FPR: 1.0000

Evaluating client 6...
Loading 539473 malicious samples with 48 features
Client 6 Results:
  AUROC: 0.9286
  AUPR: 0.9993
  Optimal threshold: 12.4479
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0717
  TPR at 1% FPR: 0.0024
  TPR at 5% FPR: 0.0042
  TPR at 10% FPR: 1.0000

Evaluating client 7...
Loading 539473 malicious samples with 48 features
Client 7 Results:
  AUROC: 0.9388
  AUPR: 0.9865
  Optimal threshold: 12.2012
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0612
  TPR at 1% FPR: 0.0000
  TPR at 5% FPR: 0.0000
  TPR at 10% FPR: 1.0000

Evaluating client 8...
Loading 539473 malicious samples with 48 features
Client 8 Results:
  AUROC: 0.9359
  AUPR: 0.9947
  Optimal threshold: 12.0067
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0641
  TPR at 1% FPR: 0.0000
  TPR at 5% FPR: 0.0000
  TPR at 10% FPR: 1.0000

Evaluating client 9...
Loading 539473 malicious samples with 48 features
Client 9 Results:
  AUROC: 0.9921
  AUPR: 1.0000
  Optimal threshold: 13.8511
  Detection Rate (TPR) at optimal threshold: 0.9976
  False Positive Rate at optimal threshold: 0.0630
  TPR at 1% FPR: 0.9486
  TPR at 5% FPR: 0.9784
  TPR at 10% FPR: 1.0000

=== Evaluating Ensemble Performance ===
Loading 539473 malicious samples with 48 features

Ensemble Results (mean aggregation):
  AUROC: 0.9537
  AUPR: 0.9995
  Optimal threshold: 12.0067
  Detection Rate (TPR) at optimal threshold: 1.0000
  False Positive Rate at optimal threshold: 0.0620
  TPR at 1% FPR: 0.2080
  TPR at 5% FPR: 0.2854
  TPR at 10% FPR: 1.0000
Client performance plot saved to results/personalized_gae_client_performance.png
Traceback (most recent call last):
  File "/home/webcronx/Projects/g-pfl-ids/src/personalized_evaluator.py", line 486, in <module>
    evaluator.plot_distance_distributions(client_results,
  File "/home/webcronx/Projects/g-pfl-ids/src/personalized_evaluator.py", line 379, in plot_distance_distributions
    dist = torch.norm(embeddings - center, dim=1)
RuntimeError: The size of tensor a (128) must match the size of tensor b (64) at non-singleton dimension 1
